{"remainingRequest":"/home/encima/.nvm/versions/node/v11.0.0/lib/node_modules/@vue/cli-service-global/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/encima/dev/uzh/shared-components/src/components/Comments.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/encima/dev/uzh/shared-components/src/components/Comments.vue","mtime":1573386383380},{"path":"/home/encima/.nvm/versions/node/v11.0.0/lib/node_modules/@vue/cli-service-global/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/encima/.nvm/versions/node/v11.0.0/lib/node_modules/@vue/cli-service-global/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/encima/.nvm/versions/node/v11.0.0/lib/node_modules/@vue/cli-service-global/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCgppbXBvcnQge21hcFN0YXRlfSBmcm9tICd2dWV4JwppbXBvcnQgR3Jvd2luZ1RleHRhcmVhIGZyb20gIi4vR3Jvd2luZ1RleHRhcmVhIjsKaW1wb3J0IFVzZXJBdmF0YXIgZnJvbSAiLi9Vc2VyQXZhdGFyIjsKCgpleHBvcnQgZGVmYXVsdCB7CiAgICBuYW1lOiAiQ29tbWVudHMiLAogICAgY29tcG9uZW50czogewogICAgICAgIEdyb3dpbmdUZXh0YXJlYSwKICAgICAgICBVc2VyQXZhdGFyCiAgICB9LAogICAgZGF0YSgpIHsKICAgICAgICByZXR1cm4gewogICAgICAgICAgICBjb21tZW50VHJlZTogW10sCiAgICAgICAgICAgIHRyZWVTaXR1YXRpb246IFtdLAogICAgICAgICAgICBuZXdTaXR1YXRpb25PbkxvYWQ6IHRydWUsCiAgICAgICAgICAgIHRvcGljc1Nob3duOiA1LAogICAgICAgICAgICByZXBsaWVzU2hvd25EZWZhdWx0OiAyLAogICAgICAgICAgICByZXBseVN1Ym1pdHRlZDogbnVsbCwKCiAgICAgICAgICAgIGNvbW1lbnRUaXRsZTogJycsCiAgICAgICAgICAgIGNvbW1lbnRUZXh0OiAnJywKICAgICAgICAgICAgcmVwbHlUZXh0czogW10KICAgICAgICB9CiAgICB9LAogICAgcHJvcHM6IHsKICAgICAgICBzb3VyY2VJZDogewogICAgICAgICAgdHlwZTogU3RyaW5nLAogICAgICAgICAgZGVmYXVsdDogbnVsbAogICAgICAgIH0KICAgIH0sCiAgICB3YXRjaDogewogICAgICAgIHNvdXJjZUlkOiBmdW5jdGlvbigpIHsKICAgICAgICAgICAgdGhpcy5sb2FkQ29tbWVudHMoKTsKICAgICAgICB9CiAgICB9LAogICAgY29tcHV0ZWQ6IHsKICAgICAgICAuLi5tYXBTdGF0ZSh7CiAgICAgICAgICAgIHVzZXI6IHN0YXRlID0+IHN0YXRlLmMzcy51c2VyLAogICAgICAgICAgICBjb21tZW50czogc3RhdGUgPT4gc3RhdGUuYzNzLmNvbW1lbnRzLmNvbW1lbnRzLAoKICAgICAgICAgICAgbG9hZGluZzogc3RhdGUgPT4gc3RhdGUuYzNzLnNldHRpbmdzLmxvYWRpbmcKICAgICAgICB9KQogICAgfSwKICAgIG1vdW50ZWQ6IGZ1bmN0aW9uKCkgewogICAgICAgIHRoaXMubG9hZENvbW1lbnRzKCk7CiAgICB9LAogICAgbWV0aG9kczogewogICAgICAgIGxvYWRDb21tZW50czogZnVuY3Rpb24oKSB7CgogICAgICAgICAgICBsZXQgcXVlcnkgPSB7CiAgICAgICAgICAgICAgICAnc2VsZWN0JzogewogICAgICAgICAgICAgICAgICAgICdmaWVsZHMnOiBbCiAgICAgICAgICAgICAgICAgICAgICAgICdjb21tZW50cy5pZCBhcyBjb21tZW50X2lkJywKICAgICAgICAgICAgICAgICAgICAgICAgJ2NvbW1lbnRzLmNyZWF0ZWRfYXQgYXMgY29tbWVudF9jcmVhdGVkJywKICAgICAgICAgICAgICAgICAgICAgICAgJyonCiAgICAgICAgICAgICAgICAgICAgXSwKICAgICAgICAgICAgICAgICAgICAndGFibGVzJzogWwogICAgICAgICAgICAgICAgICAgICAgICAnY29tbWVudHMnCiAgICAgICAgICAgICAgICAgICAgXSwKICAgICAgICAgICAgICAgICAgICAnb3JkZXJCeSc6IHsKICAgICAgICAgICAgICAgICAgICAgICAgJ2NvbW1lbnRfY3JlYXRlZCc6ICdERVNDJwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAiam9pbiI6IHsKICAgICAgICAgICAgICAgICAgICAidHlwZSI6ICJMRUZUIiwKICAgICAgICAgICAgICAgICAgICAiY29uZGl0aW9ucyI6ewogICAgICAgICAgICAgICAgICAgICAgICAiZnJvbSI6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ0YWJsZSI6ICJ1c2VycyIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiZmllbGQiOiAiaWQiCiAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICJ0byI6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ0YWJsZSI6ICJjb21tZW50cyIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiZmllbGQiOiAidXNlcl9pZCIKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAnd2hlcmUnOiBbCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAiZmllbGQiOiAnc291cmNlX2lkJywKICAgICAgICAgICAgICAgICAgICAgICAgJ29wJzogJ2UnLAogICAgICAgICAgICAgICAgICAgICAgICAndmFsJzogdGhpcy5zb3VyY2VJZAogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIF0KICAgICAgICAgICAgfTsKCiAgICAgICAgICAgIHRoaXMuJHN0b3JlLmRpc3BhdGNoKCdjM3MvbWVkaWEvZ2V0TWVkaWEnLCBbcXVlcnksICdjM3MvY29tbWVudHMvU0VUX0NPTU1FTlRTJywgOTk5OV0gKS50aGVuKHJlcyA9PiB7CgogICAgICAgICAgICAgICAgdGhpcy5jb21tZW50VGl0bGUgPSAnJzsKICAgICAgICAgICAgICAgIHRoaXMuY29tbWVudFRleHQgPSAnJzsKICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coJ2NvbW1lbnRzIGxvYWRlZDonKTsKICAgICAgICAgICAgICAgIHRoaXMuYnVpbGRDb21tZW50VHJlZSgpOwogICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyggdGhpcy5jb21tZW50VHJlZSApOwoKICAgICAgICAgICAgfSk7CiAgICAgICAgfSwKICAgICAgICBidWlsZENvbW1lbnRUcmVlKCkgewoKICAgICAgICAgICAgaWYoIHRoaXMubmV3U2l0dWF0aW9uT25Mb2FkICkgewogICAgICAgICAgICAgICAgdGhpcy50cmVlU2l0dWF0aW9uID0gW107CiAgICAgICAgICAgICAgICB0aGlzLnJlcGx5VGV4dHMgPSBbXTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy9jb25zb2xlLmxvZygnYnVpbGQgdHJlZScpOwogICAgICAgICAgICB0aGlzLmNvbW1lbnRUcmVlID0gW107CiAgICAgICAgICAgIHZhciB1bmZvdW5kQ2hpbGRyZW4gPSBbXTsKCiAgICAgICAgICAgIGZvciggbGV0IGkgPSAwOyBpIDwgdGhpcy5jb21tZW50cy5sZW5ndGg7IGkrKyApIHsKCiAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKCdjb21tZW50IGNoZWNrJyk7CgogICAgICAgICAgICAgICAgaWYoIHRoaXMuY29tbWVudHNbaV0ucGFyZW50ID09PSBudWxsICkgewoKICAgICAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKCdoYXMgbm8gcGFyZW50Jyk7CgogICAgICAgICAgICAgICAgICAgIHRoaXMuY29tbWVudFRyZWUucHVzaCggWyB0aGlzLmNvbW1lbnRzW2ldLCBbXSBdICk7CgogICAgICAgICAgICAgICAgICAgIGlmKCB0aGlzLm5ld1NpdHVhdGlvbk9uTG9hZCApIHsKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy50cmVlU2l0dWF0aW9uLnB1c2goIFsgdGhpcy5yZXBsaWVzU2hvd25EZWZhdWx0LCBmYWxzZSBdICk7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVwbHlUZXh0cy5wdXNoKCAnJyApOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBpZiggdGhpcy5yZXBseVN1Ym1pdHRlZCAhPSBudWxsICkgewogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlcGx5VGV4dHNbdGhpcy5yZXBseVN1Ym1pdHRlZF0gPSAnJzsKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXBseVN1Ym1pdHRlZCA9IG51bGw7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZSB7CgogICAgICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coJ2hhcyBwYXJlbnQnKTsKICAgICAgICAgICAgICAgICAgICB2YXIgcGFyZW50Rm91bmQgPSBmYWxzZTsKCiAgICAgICAgICAgICAgICAgICAgZm9yKCBsZXQgaiA9IDA7IGogPCB0aGlzLmNvbW1lbnRUcmVlLmxlbmd0aDsgaisrICkgewoKICAgICAgICAgICAgICAgICAgICAgICAgaWYoIHRoaXMuY29tbWVudHNbaV0ucGFyZW50ID09PSB0aGlzLmNvbW1lbnRUcmVlW2pdWzBdLmNvbW1lbnRfaWQgKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFkZENoaWxkVG9UcmVlKCBqLCB0aGlzLmNvbW1lbnRzW2ldICk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJlbnRGb3VuZCA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIGlmKCAhcGFyZW50Rm91bmQgKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coJ3BhcmVudCBub3QgZm91bmQnKTsKICAgICAgICAgICAgICAgICAgICAgICAgdW5mb3VuZENoaWxkcmVuLnVuc2hpZnQoIHRoaXMuY29tbWVudHNbaV0gKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGZvciggbGV0IGkgPSB1bmZvdW5kQ2hpbGRyZW4ubGVuZ3RoLTE7IGkgPj0gMDsgaS0tICkgewoKICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coJ2xvc3QgY2hpbGQnKTsKCiAgICAgICAgICAgICAgICBmb3IoIGxldCBqID0gMDsgaiA8IHRoaXMuY29tbWVudFRyZWUubGVuZ3RoOyBqKysgKSB7CiAgICAgICAgICAgICAgICAgICAgaWYoIHVuZm91bmRDaGlsZHJlbltpXS5wYXJlbnQgPT09IHRoaXMuY29tbWVudFRyZWVbal1bMF0uY29tbWVudF9pZCApIHsKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hZGRDaGlsZFRvVHJlZSggaiwgdW5mb3VuZENoaWxkcmVuW2ldICk7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgIH0KICAgICAgICAgICAgLy9jb25zb2xlLmxvZygnY29tbWVudCB0cmVlIGdlbmVyYXRlZCcpOwogICAgICAgICAgICAvL2NvbnNvbGUubG9nKCdyZXBseSB0ZXh0cycpOwogICAgICAgICAgICAvL2NvbnNvbGUubG9nKCB0aGlzLnJlcGx5VGV4dHMgKTsKICAgICAgICB9LAogICAgICAgIGFkZENoaWxkVG9UcmVlKCBwYXJlbnRJbmRleCwgY2hpbGQgKSB7CiAgICAgICAgICAgIC8vY29uc29sZS5sb2coJ3BhcmVudCBmb3VuZCcpOwogICAgICAgICAgICB0aGlzLmNvbW1lbnRUcmVlW3BhcmVudEluZGV4XVsxXS5wdXNoKCBjaGlsZCApOwogICAgICAgIH0sCiAgICAgICAgZ2l2ZURhdGVUaW1lKHRpbWVzdGFtcCkgewogICAgICAgICAgICB2YXIgZGF0ZSA9IG5ldyBEYXRlKHRpbWVzdGFtcCk7CiAgICAgICAgICAgIHZhciBkYXRlX3RpbWUgPSAgZGF0ZS5nZXREYXRlKCkgKycuJysgKGRhdGUuZ2V0TW9udGgoKSsxKSArJy4nKyBkYXRlLmdldEZ1bGxZZWFyKCkrJywgJysgZGF0ZS5nZXRIb3VycygpICsnOicrIChkYXRlLmdldE1pbnV0ZXMoKTwxMD8nMCc6JycpICsgZGF0ZS5nZXRNaW51dGVzKCk7CiAgICAgICAgICAgIC8vY29uc29sZS5sb2coIGRhdGVfdGltZSApOwogICAgICAgICAgICByZXR1cm4gZGF0ZV90aW1lOwogICAgICAgIH0sCiAgICAgICAgc2hvd01vcmUoKSB7CiAgICAgICAgICAgIHRoaXMudG9waWNzU2hvd24gKz0gMTA7CiAgICAgICAgfSwKICAgICAgICBleHBhbmQoaW5kZXgpIHsKICAgICAgICAgICAgdGhpcy50cmVlU2l0dWF0aW9uW2luZGV4XVswXSArPSAxMDsKCiAgICAgICAgICAgIHRoaXMudHJlZVNpdHVhdGlvbi5wdXNoKCBbJ2R1bW15IG9iamVjdCddICk7CiAgICAgICAgICAgIHRoaXMudHJlZVNpdHVhdGlvbi5wb3AoKTsKCiAgICAgICAgICAgIC8vY29uc29sZS5sb2coICdleHBhbmQnKTsKICAgICAgICAgICAgLy9jb25zb2xlLmxvZyggdGhpcy50cmVlU2l0dWF0aW9uICk7CiAgICAgICAgfSwKICAgICAgICBzaG93UmVwbHlGaWVsZChpbmRleCkgewogICAgICAgICAgICB0aGlzLnRyZWVTaXR1YXRpb25baW5kZXhdWzFdID0gdHJ1ZTsKCiAgICAgICAgICAgIHRoaXMudHJlZVNpdHVhdGlvbi5wdXNoKCBbJ2R1bW15IG9iamVjdCddICk7CiAgICAgICAgICAgIHRoaXMudHJlZVNpdHVhdGlvbi5wb3AoKTsKCiAgICAgICAgICAgIC8vY29uc29sZS5sb2coICdzaG93Jyk7CiAgICAgICAgICAgIC8vY29uc29sZS5sb2coIHRoaXMudHJlZVNpdHVhdGlvbiApOwogICAgICAgIH0sCiAgICAgICAgbmV3Q29tbWVudDogZnVuY3Rpb24ocGFyZW50SWQsIGluZGV4KSB7CgoKICAgICAgICAgICAgLy9jb25zb2xlLmxvZygnbmV3IGNvbW1lbnQnKTsKCiAgICAgICAgICAgIGxldCBjb21tZW50OwogICAgICAgICAgICBpZiggIXBhcmVudElkICYmICFpbmRleCApIHsKICAgICAgICAgICAgICAgIHRoaXMubmV3U2l0dWF0aW9uT25Mb2FkID0gdHJ1ZTsKCiAgICAgICAgICAgICAgICB0aGlzLm9wZW5lZCA9IFtdOwogICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZygnbm8gcGFyZW50Jyk7CgogICAgICAgICAgICAgICAgY29tbWVudCA9IHsKICAgICAgICAgICAgICAgICAgICB1c2VyX2lkOiB0aGlzLnVzZXIuY3VycmVudFVzZXIuaWQsCiAgICAgICAgICAgICAgICAgICAgc291cmNlX2lkOiB0aGlzLnNvdXJjZUlkLAogICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IHsKICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6IHRoaXMuY29tbWVudFRpdGxlLAogICAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiB0aGlzLmNvbW1lbnRUZXh0CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgIHRoaXMubmV3U2l0dWF0aW9uT25Mb2FkID0gZmFsc2U7CiAgICAgICAgICAgICAgICB0aGlzLnJlcGx5U3VibWl0dGVkID0gaW5kZXg7CgogICAgICAgICAgICAgICAgY29tbWVudCA9IHsKICAgICAgICAgICAgICAgICAgICB1c2VyX2lkOiB0aGlzLnVzZXIuY3VycmVudFVzZXIuaWQsCiAgICAgICAgICAgICAgICAgICAgc291cmNlX2lkOiB0aGlzLnNvdXJjZUlkLAogICAgICAgICAgICAgICAgICAgIHBhcmVudDogcGFyZW50SWQsCiAgICAgICAgICAgICAgICAgICAgY29udGVudDogewogICAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiB0aGlzLnJlcGx5VGV4dHNbaW5kZXhdCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy9jb25zb2xlLmxvZygnY3JlYXRlOiAnKyBwYXJlbnRJZCk7CgogICAgICAgICAgICB0aGlzLiRzdG9yZS5kaXNwYXRjaCgnYzNzL2NvbW1lbnRzL2NyZWF0ZUNvbW1lbnQnLCBjb21tZW50KS50aGVuKHJlcyA9PiB7CgogICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZygnbmV3IGNvbW1lbnQgY3JlYXRlZCcpOwoKICAgICAgICAgICAgICAgIHRoaXMubG9hZENvbW1lbnRzKCk7CgogICAgICAgICAgICB9KTsKICAgICAgICB9CiAgICB9Cn0KCg=="},{"version":3,"sources":["Comments.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqIA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;;AAGA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA","file":"Comments.vue","sourceRoot":"src/components","sourcesContent":["<i18n>\n    {\n\n    \"en\": {\n\n    \"newtopic-heading\": \"Start a new Topic\",\n    \"newtopic-title-placeholder\": \"Topic Title\",\n    \"newtopic-text-placeholder\": \"What's on your mind?\",\n    \"newtopic-button\": \"Send\",\n\n    \"login-text\": \"You need to be logged in to write something.\",\n    \"login-button\": \"Login\",\n\n    \"reply-button\": \"Reply\",\n    \"reply-placeholder\": \"Reply\",\n\n    \"more-replies-button\": \"Show More Replies\",\n    \"more-comments-button\": \"Show More Comments\"\n\n    },\n    \"de\": {\n\n    \"newtopic-heading\": \"Starte ein neues Thema\",\n    \"newtopic-title-placeholder\": \"Titel\",\n    \"newtopic-text-placeholder\": \"Was liegt dir auf dem Herzen?\",\n    \"newtopic-button\": \"Senden\",\n\n    \"login-text\": \"Du musst eingeloggt sein um etwas zu schreiben.\",\n    \"login-button\": \"Anmelden\",\n\n    \"reply-button\": \"Antworten\",\n    \"reply-placeholder\": \"Antwort\",\n\n\n    \"more-replies-button\": \"Mehr Antworten zeigen\",\n    \"more-comments-button\": \"Mehr Kommentare zeigen\"\n\n    }\n\n    }\n</i18n>\n\n<template>\n    <div class=\"comments\">\n\n        <template v-if=\"!user.isAnon\">\n\n            <h3 class=\"subheading\">{{ $t('newtopic-heading') }}</h3>\n\n            <div class=\"comment\">\n\n                <user-avatar class=\"avatar\" :username=\"user.currentUser.username\"></user-avatar>\n\n                <div class=\"form-field\">\n                    <growing-textarea v-model=\"commentTitle\" :placeholder=\"$t('newtopic-title-placeholder')\" fat></growing-textarea>\n                </div>\n                <div class=\"form-field\">\n                    <growing-textarea v-model=\"commentText\" :placeholder=\"$t('newtopic-text-placeholder')\"></growing-textarea>\n                </div>\n\n                <div class=\"button-group right-aligned\">\n                    <button :disabled=\"commentTitle === '' || commentText === ''\" class=\"button button-primary\" @click=\"newComment()\">{{ $t('newtopic-button') }}</button>\n                </div>\n\n            </div>\n\n        </template>\n        <template v-else>\n\n            <p>{{ $t('login-text') }}</p>\n            <router-link tag=\"button\" to=\"/login\" class=\"button button-primary\">{{ $t('login-button') }}</router-link>\n\n        </template>\n\n        <ul v-if=\"treeSituation.length > 0\" class=\"comment-list\">\n            <li v-if=\"index < topicsShown\" v-for=\"(situation,index) in treeSituation\">\n\n                <div class=\"comment comment-existing withTitles\">\n\n                    <user-avatar class=\"avatar\" :username=\"commentTree[index][0].username\"></user-avatar>\n\n                    <h3 class=\"subheading\">{{ commentTree[index][0].content.title }}</h3>\n                    <p>{{ commentTree[index][0].content.text }}</p>\n                    <span class=\"date\">{{ giveDateTime(commentTree[index][0].comment_created) }}</span>\n                    <span class=\"username\">by {{ commentTree[index][0].username }}</span>\n\n                    <template v-if=\"!user.isAnon\">\n                        <div v-if=\"!situation[1]\" class=\"button-group right-aligned\">\n                            <button @click.prevent=\"showReplyField(index)\" class=\"button button-secondary button-secondary-naked\">{{ $t('reply-button') }}</button>\n                        </div>\n                        <div v-else class=\"comment reply\">\n                            <user-avatar class=\"avatar\" :username=\"user.currentUser.username\"></user-avatar>\n\n                            <div class=\"form-field\">\n                                <growing-textarea v-model=\"replyTexts[index]\" :placeholder=\"$t('reply-placeholder')\"></growing-textarea>\n                            </div>\n                            <div class=\"button-group right-aligned\">\n                                <button :disabled=\"replyTexts[index].length === 0\" class=\"button button-primary\" @click=\"newComment(commentTree[index][0].comment_id, index)\">{{ $t('reply-button') }}</button>\n                            </div>\n                        </div>\n                    </template>\n\n                    <div class=\"replies\" v-if=\"commentTree[index][1].length > 0\">\n\n                        <ul class=\"reply-list\">\n\n                            <li v-if=\"replyIndex < situation[0]\" v-for=\"(reply,replyIndex) in commentTree[index][1]\">\n                                <div class=\"comment comment-existing\">\n                                    <user-avatar class=\"avatar\" :username=\"reply.username\"></user-avatar>\n                                    <p>{{ reply.content.text }}</p>\n                                    <span class=\"date\">{{ giveDateTime(reply.comment_created) }}</span>\n                                    <span class=\"username\">by {{ reply.username }}</span>\n                                </div>\n                            </li>\n\n                        </ul>\n                        <div v-if=\"commentTree[index][1].length > situation[0]\" class=\"button-group\">\n                            <button @click.prevent=\"expand(index)\" class=\"button button-secondary button-secondary-naked\">{{ $t('more-replies-button') }}</button>\n                        </div>\n                    </div>\n\n                </div>\n            </li>\n        </ul>\n        <div v-if=\"commentTree.length > topicsShown\" class=\"button-group\">\n            <button @click.prevent=\"showMore()\" class=\"button button-secondary\">{{ $t('more-comments-button') }}</button>\n        </div>\n\n    </div>\n</template>\n\n<script>\n\n    import {mapState} from 'vuex'\n    import GrowingTextarea from \"./GrowingTextarea\";\n    import UserAvatar from \"./UserAvatar\";\n\n\n    export default {\n        name: \"Comments\",\n        components: {\n            GrowingTextarea,\n            UserAvatar\n        },\n        data() {\n            return {\n                commentTree: [],\n                treeSituation: [],\n                newSituationOnLoad: true,\n                topicsShown: 5,\n                repliesShownDefault: 2,\n                replySubmitted: null,\n\n                commentTitle: '',\n                commentText: '',\n                replyTexts: []\n            }\n        },\n        props: {\n            sourceId: {\n              type: String,\n              default: null\n            }\n        },\n        watch: {\n            sourceId: function() {\n                this.loadComments();\n            }\n        },\n        computed: {\n            ...mapState({\n                user: state => state.c3s.user,\n                comments: state => state.c3s.comments.comments,\n\n                loading: state => state.c3s.settings.loading\n            })\n        },\n        mounted: function() {\n            this.loadComments();\n        },\n        methods: {\n            loadComments: function() {\n\n                let query = {\n                    'select': {\n                        'fields': [\n                            'comments.id as comment_id',\n                            'comments.created_at as comment_created',\n                            '*'\n                        ],\n                        'tables': [\n                            'comments'\n                        ],\n                        'orderBy': {\n                            'comment_created': 'DESC'\n                        }\n                    },\n                    \"join\": {\n                        \"type\": \"LEFT\",\n                        \"conditions\":{\n                            \"from\": {\n                                \"table\": \"users\",\n                                \"field\": \"id\"\n                            },\n                            \"to\": {\n                                \"table\": \"comments\",\n                                \"field\": \"user_id\"\n                            }\n                        }\n                    },\n                    'where': [\n                        {\n                            \"field\": 'source_id',\n                            'op': 'e',\n                            'val': this.sourceId\n                        }\n                    ]\n                };\n\n                this.$store.dispatch('c3s/media/getMedia', [query, 'c3s/comments/SET_COMMENTS', 9999] ).then(res => {\n\n                    this.commentTitle = '';\n                    this.commentText = '';\n                    //console.log('comments loaded:');\n                    this.buildCommentTree();\n                    //console.log( this.commentTree );\n\n                });\n            },\n            buildCommentTree() {\n\n                if( this.newSituationOnLoad ) {\n                    this.treeSituation = [];\n                    this.replyTexts = [];\n                }\n\n                //console.log('build tree');\n                this.commentTree = [];\n                var unfoundChildren = [];\n\n                for( let i = 0; i < this.comments.length; i++ ) {\n\n                    //console.log('comment check');\n\n                    if( this.comments[i].parent === null ) {\n\n                        //console.log('has no parent');\n\n                        this.commentTree.push( [ this.comments[i], [] ] );\n\n                        if( this.newSituationOnLoad ) {\n                            this.treeSituation.push( [ this.repliesShownDefault, false ] );\n                            this.replyTexts.push( '' );\n                        }\n                        if( this.replySubmitted != null ) {\n                            this.replyTexts[this.replySubmitted] = '';\n                            this.replySubmitted = null;\n                        }\n                    }\n                    else {\n\n                        //console.log('has parent');\n                        var parentFound = false;\n\n                        for( let j = 0; j < this.commentTree.length; j++ ) {\n\n                            if( this.comments[i].parent === this.commentTree[j][0].comment_id ) {\n                                this.addChildToTree( j, this.comments[i] );\n                                parentFound = true;\n                            }\n                        }\n\n                        if( !parentFound ) {\n                            //console.log('parent not found');\n                            unfoundChildren.unshift( this.comments[i] );\n                        }\n                    }\n                }\n\n                for( let i = unfoundChildren.length-1; i >= 0; i-- ) {\n\n                    //console.log('lost child');\n\n                    for( let j = 0; j < this.commentTree.length; j++ ) {\n                        if( unfoundChildren[i].parent === this.commentTree[j][0].comment_id ) {\n                            this.addChildToTree( j, unfoundChildren[i] );\n                            break;\n                        }\n                    }\n\n                }\n                //console.log('comment tree generated');\n                //console.log('reply texts');\n                //console.log( this.replyTexts );\n            },\n            addChildToTree( parentIndex, child ) {\n                //console.log('parent found');\n                this.commentTree[parentIndex][1].push( child );\n            },\n            giveDateTime(timestamp) {\n                var date = new Date(timestamp);\n                var date_time =  date.getDate() +'.'+ (date.getMonth()+1) +'.'+ date.getFullYear()+', '+ date.getHours() +':'+ (date.getMinutes()<10?'0':'') + date.getMinutes();\n                //console.log( date_time );\n                return date_time;\n            },\n            showMore() {\n                this.topicsShown += 10;\n            },\n            expand(index) {\n                this.treeSituation[index][0] += 10;\n\n                this.treeSituation.push( ['dummy object'] );\n                this.treeSituation.pop();\n\n                //console.log( 'expand');\n                //console.log( this.treeSituation );\n            },\n            showReplyField(index) {\n                this.treeSituation[index][1] = true;\n\n                this.treeSituation.push( ['dummy object'] );\n                this.treeSituation.pop();\n\n                //console.log( 'show');\n                //console.log( this.treeSituation );\n            },\n            newComment: function(parentId, index) {\n\n\n                //console.log('new comment');\n\n                let comment;\n                if( !parentId && !index ) {\n                    this.newSituationOnLoad = true;\n\n                    this.opened = [];\n                    //console.log('no parent');\n\n                    comment = {\n                        user_id: this.user.currentUser.id,\n                        source_id: this.sourceId,\n                        content: {\n                            title: this.commentTitle,\n                            text: this.commentText\n                        }\n                    };\n                }\n                else {\n                    this.newSituationOnLoad = false;\n                    this.replySubmitted = index;\n\n                    comment = {\n                        user_id: this.user.currentUser.id,\n                        source_id: this.sourceId,\n                        parent: parentId,\n                        content: {\n                            text: this.replyTexts[index]\n                        }\n                    };\n                }\n\n                //console.log('create: '+ parentId);\n\n                this.$store.dispatch('c3s/comments/createComment', comment).then(res => {\n\n                    //console.log('new comment created');\n\n                    this.loadComments();\n\n                });\n            }\n        }\n    }\n\n</script>\n\n<style lang=\"scss\">\n\n    @import '@/styles/theme.scss';\n    @import '@/styles/shared/variables.scss';\n\n\n    .comments {\n\n\n        min-height: 50vh;\n\n\n        .button-secondary-naked {\n            padding: 0;\n        }\n\n\n        ul {\n            li {\n                padding-left: 0;\n                margin-left: 0;\n                &:before {\n                    display: none;\n                }\n            }\n        }\n\n\n        .form-field {\n            display: block;\n\n            margin-bottom: $spacing-2;\n        }\n\n        .comment {\n            position: relative;\n            padding-left: calc(40px + #{$spacing-2});\n\n\n            .avatar {\n                position: absolute;\n                top: 0;\n                left: 0;\n                pointer-events: none;\n            }\n\n            p, .subheading {\n                white-space: pre-line;\n            }\n\n\n        }\n        .comment-list {\n            margin-top: $spacing-5;\n            margin-bottom: $spacing-3;\n\n            li {\n                margin-bottom: $spacing-4;\n\n                .comment {\n\n                    &.comment-existing {\n                        padding-top: calc((40px - #{$font-size-normal} * 1.5) / 2);\n                        min-height: 40px;\n                        &.titled {\n                            padding-top: calc((40px - #{$font-size-medium} * 1.5) / 2);\n                        }\n                    }\n\n                    .subheading {\n                        margin-bottom: $spacing-1;\n                    }\n                    p {\n                        margin-bottom: 0;\n                    }\n                    .date, .username {\n                        font-size: $font-size-small;\n                        color: $color-black-tint-50;\n                        display: inline;\n\n                        &.username {\n                            margin-left: $spacing-1;\n                        }\n                    }\n\n                    .reply {\n                        margin-top: $spacing-3;\n                    }\n\n                    .replies {\n                        margin-top: $spacing-1;\n\n                        .reply-list {\n                            margin: 0;\n\n                            li {\n                                margin-bottom: $spacing-2;\n                            }\n                        }\n                    }\n\n                }\n\n            }\n\n        }\n    }\n\n    @media only screen and (min-width: $viewport-tablet-portrait) {\n\n        .comments {\n\n            .comment {\n                padding-left: calc( 48px + #{$spacing-3} );\n            }\n\n            .comment-list {\n                margin-top: $spacing-6;\n                margin-bottom: $spacing-4;\n\n                li {\n                    margin-bottom: $spacing-5;\n\n                    .comment {\n\n                        &.comment-existing {\n                            padding-top: calc((48px - #{$font-size-normal} * 1.5) / 2);\n                            min-height: 48px;\n                            &.titled {\n                                padding-top: calc((48px - #{$font-size-medium} * 1.5) / 2);\n                            }\n                        }\n\n                        .subheading {\n                            margin-bottom: $spacing-2;\n                        }\n\n                        .reply {\n                            margin-top: $spacing-4;\n                        }\n\n\n                        .replies {\n                            margin-top: $spacing-2;\n\n                            .reply-list {\n                                margin: 0;\n\n                                li {\n                                    margin-bottom: $spacing-3;\n                                }\n                            }\n                        }\n\n                    }\n\n                }\n\n\n            }\n        }\n\n    }\n\n</style>\n"]}]}